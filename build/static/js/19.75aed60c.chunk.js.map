{"version":3,"sources":["pages/hospitalAppointment/index.js","pages/hospitalAppointment/service.js","components/comTable/index.js","components/rejectModal/index.js"],"names":["statusCfg","2","3","4","5","HospitalAppointment","p","getPageData","getAppointList","state","current","then","res","status","setState","dataSource","data","map","v","productName","product","name","appointmentName","appointment","appointmentPhone","phone","appointmentOrderAt","orderAt","appointmentRemark","remark","total","catch","e","console","log","onChangePage","page","onOrderRegister","id","orderRegister","message","success","error","onCancel","visible","selectRow","showCaseModal","record","handleOk","orderCase","content","mode","this","columns","title","dataIndex","key","align","render","renderTime","width","disabled","type","style","marginRight","onClick","React","Component","Fetch","Home","props","marginTop","bordered","pagination","rowKey","getRowKey","size","className","onChange","float","TextArea","Input","value","target","preProps","onOk","rows","defaultProps"],"mappings":"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","file":"static/js/19.75aed60c.chunk.js","sourcesContent":["import React from \"react\";\r\nimport { Button, message } from \"antd\";\r\nimport ComTable from \"../../components/comTable\";\r\nimport { getAppointList, orderRegister, orderCase } from './service';\r\nimport { renderTime } from '../../utils/util';\r\nimport RejectModal from '../../components/rejectModal';\r\n\r\nconst statusCfg = {\r\n  2: '待挂号',\r\n  3: '待使用',\r\n  4: '待评价',\r\n  5: '完成',\r\n}\r\n\r\nconst daiguahao = 2;\r\n\r\nexport default class HospitalAppointment extends React.Component {\r\n  constructor(p) {\r\n    super(p);\r\n    this.state = {\r\n      mode: \"\",\r\n      visible: false,\r\n      current: 1,\r\n      total: 0,\r\n      dataSource: [],\r\n      selectRow: {},\r\n    };\r\n  }\r\n  componentDidMount() {\r\n    this.getPageData();\r\n  }\r\n  getPageData = () => {\r\n    getAppointList(this.state.current)\r\n    .then((res) => {\r\n      if (res.status === 1) {\r\n        const dataSource = res.data.map(v => {\r\n          return {\r\n            ...v,\r\n            productName: v.product ? v.product.name : '',\r\n            appointmentName: v.appointment ? v.appointment.name : '',\r\n            appointmentPhone: v.appointment ? v.appointment.phone : '',\r\n            appointmentOrderAt: v.appointment ? v.appointment.orderAt : '',\r\n            appointmentRemark: v.appointment ? v.appointment.remark : '',\r\n          };\r\n        });\r\n        this.setState({ dataSource, total: res.total });\r\n        return;\r\n      }\r\n      this.setState({ dataSource: [] });\r\n    })\r\n    .catch((e) => {\r\n      console.log(e);\r\n    });\r\n  };\r\n  onChangePage = page => {\r\n    this.setState({\r\n      current: page,\r\n    }, () => {\r\n      this.getPageData();\r\n    });\r\n  };\r\n  onOrderRegister = (id) => ()=> {\r\n    orderRegister({ id })\r\n    .then((res) => {\r\n      if(res.status === 1){\r\n        message.success('挂号成功');\r\n        this.getPageData();\r\n        return;\r\n      }\r\n      message.error(`挂号失败:${res.message}`);\r\n    })\r\n    .catch((e) => {\r\n      console.log(e);\r\n    });\r\n  }\r\n  onCancel = () => {\r\n    this.setState({ visible: false, selectRow: {} });\r\n  }\r\n  showCaseModal = (record) => () => {\r\n    this.setState({ visible: true, selectRow: record });\r\n  }\r\n  handleOk = (v) => {\r\n    orderCase({ id: this.state.selectRow.id, content: v })\r\n    .then((res) => {\r\n      if(res.status === 1){\r\n        this.onCancel();\r\n        this.getPageData();\r\n        return;\r\n      }\r\n      message.error('提交失败');\r\n    })\r\n    .catch((e) => {\r\n      console.log(e);\r\n    });\r\n  }\r\n  render() {\r\n    const columns = [\r\n      {\r\n        title: \"产品\",\r\n        dataIndex: \"productName\",\r\n        key: \"productName\",\r\n        align: \"center\",\r\n      },\r\n      {\r\n        title: \"名字\",\r\n        dataIndex: \"appointmentName\",\r\n        key: \"appointmentName\",\r\n        align: \"center\",\r\n\r\n      },\r\n      {\r\n        title: \"电话\",\r\n        dataIndex: \"appointmentPhone\",\r\n        key: \"appointmentPhone\",\r\n        align: \"center\",\r\n      },\r\n      {\r\n        title: \"其他说明\",\r\n        dataIndex: \"appointmentRemark\",\r\n        key: \"appointmentRemark\",\r\n        align: \"center\"\r\n      },\r\n      {\r\n        title: \"预约时间\",\r\n        dataIndex: \"appointmentOrderAt\",\r\n        key: \"appointmentOrderAt\",\r\n        align: \"center\",\r\n        render: renderTime,\r\n      },\r\n      {\r\n        title: \"状态\",\r\n        dataIndex: \"status\",\r\n        key: \"status\",\r\n        align: \"center\",\r\n        render: (v) => {\r\n          return statusCfg[v]\r\n        },\r\n      },\r\n      {\r\n        title: \"操作\",\r\n        dataIndex: \"action\",\r\n        key: \"action\",\r\n        align: \"center\",\r\n        width: 200,\r\n        render: (v, record) => {\r\n          return (\r\n            <span>\r\n              <Button disabled={record.status !== daiguahao} type=\"primary\" style={{ marginRight: \"16px\" }} onClick={this.onOrderRegister(record.id)}>\r\n                挂号\r\n              </Button>\r\n              <Button type=\"primary\" onClick={this.showCaseModal(record)}>\r\n              填报病例\r\n              </Button>\r\n  \r\n            </span>\r\n          );\r\n        }\r\n      }\r\n    ];\r\n    return (\r\n      <div>\r\n        <ComTable\r\n          current={this.state.current}\r\n          total={this.state.total}\r\n          columns={columns}\r\n          dataSource={this.state.dataSource}\r\n          onChangePage={this.onChangePage}\r\n        />\r\n        <RejectModal\r\n        title='请填写病例'\r\n        visible={this.state.visible}\r\n        onCancel={this.onCancel}\r\n        handleOk={this.handleOk} \r\n        />\r\n      </div>\r\n    );\r\n  }\r\n}\r\n","import Fetch from '../../utils/fetch';\r\n\r\nexport function getAppointList(page = 1) {\r\n    return Fetch('get', `/order/hospital?page=${page}&limit=10`);\r\n}\r\n\r\nexport function orderRegister(data) {\r\n    return Fetch('post', '/order/register', data);\r\n}\r\n\r\nexport function orderCase(data) {\r\n    return Fetch('post', '/order/case', data);\r\n}\r\n","import React from 'react';\r\nimport { Table, Pagination } from 'antd';\r\nimport { getRowKey } from '../../utils/util';\r\n\r\nexport default class Home extends React.Component {\r\n    render(){\r\n        const { columns, dataSource, current, total, onChangePage } = this.props;\r\n        console.log('total', total);\r\n        return (<div style={{ marginTop: '16px' }}>\r\n        <Table\r\n          bordered\r\n          dataSource={dataSource}\r\n          columns={columns}\r\n          pagination={false}\r\n          rowKey={getRowKey}\r\n          size=\"small\"\r\n        />\r\n        <div className='clearfix'>\r\n        <Pagination\r\n          current={current}\r\n          total={total}\r\n          // pageSize={2}\r\n          onChange={onChangePage}\r\n          style={{ float: 'right', marginTop: '16px' }}\r\n        />\r\n        </div>\r\n        </div>)\r\n    }\r\n}","import React from \"react\";\r\nimport { Modal, Input, message } from \"antd\";\r\n\r\nconst { TextArea } = Input;\r\n\r\nexport default class Home extends React.Component {\r\n  state = {\r\n    value: \"\"\r\n  };\r\n  static defaultProps={\r\n    handleOk: () => {}\r\n  }\r\n  componentDidUpdate(preProps){\r\n    if (this.props.visible !== preProps.visible && !preProps.visible) {\r\n        this.setState({ value: '' });\r\n    }\r\n  }\r\n  onChange = e => {\r\n      console.log(e);\r\n    this.setState({ value: e.target.value });\r\n  };\r\n  handleOk = () => {\r\n      if(!this.state.value){\r\n          message.error('请填写');\r\n          return;\r\n      }\r\n      this.props.handleOk(this.state.value);\r\n  }\r\n  render() {\r\n    return (\r\n      <Modal\r\n        title={this.props.title}\r\n        visible={this.props.visible}\r\n        onOk={this.handleOk}\r\n        onCancel={this.props.onCancel}\r\n      >\r\n        <TextArea rows={4} onChange={this.onChange} value={this.state.value} />\r\n      </Modal>\r\n    );\r\n  }\r\n}\r\n"],"sourceRoot":""}