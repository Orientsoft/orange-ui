{"version":3,"sources":["pages/mall/comment/index.js","pages/mall/comment/service.js","components/comTable/index.js","components/previewModal/index.js"],"names":["Comment","p","getPageData","getCommentList","state","current","then","res","status","setState","dataSource","data","total","catch","e","console","log","onChangePage","page","showPreview","url","previewVisible","previewImage","previewHandleCancel","deleteComment","id","cancelCommentSpecial","commentid","message","error","filter","v","this","columns","title","dataIndex","key","align","render","text","onClick","src","alt","style","height","className","renderTime","width","record","type","handleCancel","React","Component","Fetch","Home","props","marginTop","bordered","pagination","rowKey","getRowKey","size","onChange","float","PreviewModal","renderMode","visible","footer","onCancel","minHeight","dangerouslySetInnerHTML","__html"],"mappings":"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","file":"static/js/19.662c8a42.chunk.js","sourcesContent":["import React from \"react\";\r\nimport { Button, message } from 'antd';\r\nimport ComTable from \"../../../components/comTable\";\r\nimport PreviewModal from \"../../../components/previewModal\";\r\nimport { getCommentList, cancelCommentSpecial } from \"./service\";\r\nimport { renderTime } from \"../../../utils/util\";\r\n\r\nexport default class Comment extends React.Component {\r\n  constructor(p) {\r\n    super(p);\r\n    this.state = {\r\n      previewVisible: false,\r\n      previewImage: \"\",\r\n      current: 1,\r\n      total: 0,\r\n      dataSource: []\r\n    };\r\n  }\r\n  componentDidMount() {\r\n    this.getPageData();\r\n  }\r\n  getPageData = () => {\r\n    getCommentList(this.state.current)\r\n      .then(res => {\r\n        if (res.status === 1) {\r\n          this.setState({ dataSource: res.data, total: res.total });\r\n          return;\r\n        }\r\n        this.setState({ dataSource: [] });\r\n      })\r\n      .catch(e => {\r\n        console.log(e);\r\n      });\r\n  };\r\n  onChangePage = page => {\r\n    this.setState(\r\n      {\r\n        current: page\r\n      },\r\n      () => {\r\n        this.getPageData();\r\n      }\r\n    );\r\n  };\r\n  showPreview = url => () => {\r\n    this.setState({ previewVisible: true, previewImage: url });\r\n  };\r\n  previewHandleCancel = () => {\r\n    this.setState({ previewVisible: false, previewImage: \"\" });\r\n  };\r\n  deleteComment = (id) => () => {\r\n      cancelCommentSpecial({ commentid: id })\r\n        .then(res => {\r\n          if (res.status === 1) {\r\n            const dataSource = this.state.dataSource.filter(v => v.id !== id);\r\n            this.setState({ dataSource });\r\n            return;\r\n          }\r\n          message.error(`操作失败:${res.message}`);\r\n        })\r\n        .catch(e => {\r\n          console.log(e);\r\n        });\r\n  }\r\n  render() {\r\n    const columns = [\r\n      {\r\n        title: \"产品\",\r\n        dataIndex: \"productName\",\r\n        key: \"productName\",\r\n        align: \"center\"\r\n      },\r\n      {\r\n        title: \"产品LOGO\",\r\n        dataIndex: \"productLogo\",\r\n        key: \"productLogo\",\r\n        align: \"center\",\r\n        render: text => {\r\n          return (\r\n            <img\r\n              onClick={this.showPreview(text)}\r\n              src={text}\r\n              alt=\"\"\r\n              style={{ height: \"20px\" }}\r\n              className=\"canClick\"\r\n            />\r\n          );\r\n        }\r\n      },\r\n      {\r\n        title: \"评论者\",\r\n        dataIndex: \"commentName\",\r\n        key: \"commentName\",\r\n        align: \"center\"\r\n      },\r\n      {\r\n        title: \"评论\",\r\n        dataIndex: \"comment\",\r\n        key: \"comment\",\r\n        align: \"center\"\r\n      },\r\n      {\r\n        title: \"评论时间\",\r\n        dataIndex: \"commentAt\",\r\n        key: \"commentAt\",\r\n        align: \"center\",\r\n        render: renderTime\r\n      },\r\n      {\r\n        title: \"回复\",\r\n        dataIndex: \"answer\",\r\n        key: \"answer\",\r\n        align: \"center\"\r\n      },\r\n      {\r\n        title: \"回复时间\",\r\n        dataIndex: \"answerAt\",\r\n        key: \"answerAt\",\r\n        align: \"center\",\r\n        render: renderTime\r\n      },\r\n      {\r\n        title: \"操作\",\r\n        dataIndex: \"action\",\r\n        key: \"action\",\r\n        align: \"center\",\r\n        width: 100,\r\n        render: (v, record) => {\r\n          return (\r\n            <span>\r\n              <Button\r\n                type=\"primary\"\r\n                onClick={this.deleteComment(record.id)}\r\n              >\r\n                删除\r\n              </Button>\r\n            </span>\r\n          );\r\n        }\r\n      }\r\n    ];\r\n    return (\r\n      <div>\r\n        <ComTable\r\n          current={this.state.current}\r\n          total={this.state.total}\r\n          columns={columns}\r\n          dataSource={this.state.dataSource}\r\n          onChangePage={this.onChangePage}\r\n        />\r\n        <PreviewModal\r\n          previewVisible={this.state.previewVisible}\r\n          previewImage={this.state.previewImage}\r\n          handleCancel={this.previewHandleCancel}\r\n        />\r\n      </div>\r\n    );\r\n  }\r\n}\r\n","import Fetch from '../../../utils/fetch';\r\n\r\nexport function getCommentList(page) {\r\n    return Fetch('get', `/product/comment?page=${page}&limit=10`);\r\n}\r\n\r\nexport function cancelCommentSpecial(data) {\r\n    return Fetch('delete', '/comment/operator', data);\r\n}","import React from 'react';\r\nimport { Table, Pagination } from 'antd';\r\nimport { getRowKey } from '../../utils/util';\r\n\r\nexport default class Home extends React.Component {\r\n    render(){\r\n        const { columns, dataSource, current, total, onChangePage } = this.props;\r\n        console.log('total', total);\r\n        return (<div style={{ marginTop: '16px' }}>\r\n        <Table\r\n          bordered\r\n          dataSource={dataSource}\r\n          columns={columns}\r\n          pagination={false}\r\n          rowKey={getRowKey}\r\n          size=\"small\"\r\n        />\r\n        <div className='clearfix'>\r\n        <Pagination\r\n          current={current}\r\n          total={total}\r\n          // pageSize={2}\r\n          onChange={onChangePage}\r\n          style={{ float: 'right', marginTop: '16px' }}\r\n        />\r\n        </div>\r\n        </div>)\r\n    }\r\n}","import React from \"react\";\r\nimport { Modal } from \"antd\";\r\n\r\nexport default class PreviewModal extends React.Component {\r\n  render() {\r\n    const {\r\n      previewVisible,\r\n      previewImage,\r\n      handleCancel,\r\n      renderMode\r\n    } = this.props;\r\n    console.log(\"renderMode\", renderMode);\r\n    return (\r\n      <Modal\r\n        visible={previewVisible}\r\n        footer={null}\r\n        onCancel={handleCancel}\r\n        title=\"预览\"\r\n        width={1024}\r\n      >\r\n        <div className=\"clearfix\">\r\n          {renderMode === \"draft\" ? (\r\n            <div\r\n              style={{ minHeight: '700px' }}\r\n              dangerouslySetInnerHTML={{\r\n                __html: previewImage\r\n              }}\r\n            ></div>\r\n          ) : (\r\n            <img\r\n              alt=\"example\"\r\n              style={{ width: \"100%\", height: \"100%\" }}\r\n              src={previewImage}\r\n            />\r\n          )}\r\n        </div>\r\n      </Modal>\r\n    );\r\n  }\r\n}\r\n"],"sourceRoot":""}