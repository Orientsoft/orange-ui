{"version":3,"sources":["pages/appointmentAsign/index.js","pages/appointmentAsign/service.js","pages/appointmentAsign/hospitalModal.js","components/comTable/index.js"],"names":["Home","p","getPageData","getAppointAdminList","state","current","then","res","status","setState","dataSource","data","total","catch","e","console","log","onChangePage","page","showHospital","row","visible","selectRow","onCancel","handleOk","id","appointAsign","message","success","error","this","columns","title","dataIndex","key","align","render","v","record","hospId","width","type","onClick","React","Component","Fetch","getHospitalList","HospitalModal","selectedRowKeys","onSelectChange","length","props","preProps","rowSelection","onChange","onOk","bordered","pagination","rowKey","getRowKey","size","defaultProps","style","marginTop","className","float"],"mappings":"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","file":"static/js/22.00facc46.chunk.js","sourcesContent":["import React from \"react\";\r\nimport { Button, message } from \"antd\";\r\nimport ComTable from \"../../components/comTable\";\r\nimport HospitalModal from \"./hospitalModal\";\r\nimport { getAppointAdminList, appointAsign } from './service';\r\n\r\nexport default class Home extends React.Component {\r\n  constructor(p) {\r\n    super(p);\r\n    this.state = {\r\n      visible: false,\r\n      current: 1,\r\n      total: 0,\r\n      dataSource: [],\r\n      selectRow: {},\r\n    };\r\n  }\r\n  componentDidMount() {\r\n    this.getPageData();\r\n  }\r\n  getPageData = () => {\r\n    getAppointAdminList(this.state.current)\r\n    .then((res) => {\r\n      if (res.status === 1) {\r\n        this.setState({ dataSource: res.data, total: res.total });\r\n        return;\r\n      }\r\n      this.setState({ dataSource: [] });\r\n    })\r\n    .catch((e) => {\r\n      console.log(e);\r\n    });\r\n  };\r\n  onChangePage = page => {\r\n    this.setState({\r\n      current: page,\r\n    }, () => {\r\n      this.getPageData();\r\n    });\r\n  };\r\n\r\n  showHospital = (row) => () => {\r\n    this.setState({ visible: true, selectRow: row });\r\n  };\r\n  onCancel = () => {\r\n    this.setState({\r\n      visible: false\r\n    });\r\n  };\r\n\r\n  handleOk = (id) => {\r\n    console.log('id', id);\r\n    appointAsign(this.state.selectRow.id, { id })\r\n    .then((res) => {\r\n      if (res.status === 1) {\r\n        message.success('指派成功');\r\n        this.setState({ visible: false, selectRow: {} });\r\n        this.getPageData();\r\n        return;\r\n      }\r\n      message.error(`指派失败:${res.message}`);\r\n    })\r\n    .catch((e) => {\r\n      console.log(e);\r\n    });\r\n  }\r\n  render() {\r\n    const columns = [\r\n      {\r\n        title: \"预约人\",\r\n        dataIndex: \"name\",\r\n        key: \"name\",\r\n        align: \"center\"\r\n      },\r\n      // {\r\n      //   title: \"门店\",\r\n      //   dataIndex: \"hospital\",\r\n      //   key: \"hospital\",\r\n      //   align: \"center\"\r\n      // },\r\n      {\r\n        title: \"联系电话\",\r\n        dataIndex: \"phone\",\r\n        key: \"phone\",\r\n        align: \"center\"\r\n      },\r\n    \r\n      {\r\n        title: \"预约时间\",\r\n        dataIndex: \"orderAt\",\r\n        key: \"orderAt\",\r\n        align: \"center\"\r\n      },\r\n      {\r\n        title: \"其他说明\",\r\n        dataIndex: \"remark\",\r\n        key: \"remark\",\r\n        align: \"center\"\r\n      },\r\n      {\r\n        title: \"指派医院\",\r\n        dataIndex: \"hospName\",\r\n        key: \"hospName\",\r\n        align: \"center\"\r\n      },\r\n      {\r\n        title: \"状态\",\r\n        dataIndex: \"status\",\r\n        key: \"status\",\r\n        align: \"center\",\r\n        render: (v, record) => {\r\n          return record.hospId ? '已指派' : '未指派';\r\n        }\r\n      },\r\n      {\r\n        title: \"操作\",\r\n        dataIndex: \"action\",\r\n        key: \"action\",\r\n        align: \"center\",\r\n        width: 100,\r\n        render: (v, record) => {\r\n          return (\r\n            <Button type=\"primary\" onClick={this.showHospital(record)}>\r\n              指派\r\n            </Button>\r\n          );\r\n        }\r\n      }\r\n    ];\r\n    return (\r\n      <div>\r\n        <ComTable\r\n          current={this.state.current}\r\n          total={this.state.total}\r\n          columns={columns}\r\n          dataSource={this.state.dataSource}\r\n          onChangePage={this.onChangePage}\r\n        />\r\n        <HospitalModal visible={this.state.visible} onCancel={this.onCancel} handleOk={this.handleOk}/>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n","import Fetch from '../../utils/fetch';\r\n\r\nexport function getAppointAdminList(page = 1) {\r\n    return Fetch('get', `/appointment/admin?page=${page}&limit=1000`);\r\n}\r\n\r\nexport function appointAsign(id, data) {\r\n    return Fetch('put', `/appointment/${id}`, data);\r\n}\r\n\r\nexport function getHospitalList(page = 1) {\r\n    return Fetch('get', `/hospital?page=${page}&limit=10`);\r\n}\r\n\r\n","import React from \"react\";\r\nimport { Modal, Table, message } from \"antd\";\r\nimport { getRowKey } from \"../../utils/util\";\r\nimport { getHospitalList } from './service';\r\n\r\nconst columns = [\r\n  {\r\n    title: \"医院名\",\r\n    dataIndex: \"name\",\r\n    key: \"name\",\r\n    align: \"center\"\r\n  }\r\n];\r\n\r\nexport default class HospitalModal extends React.Component {\r\n  static defaultProps = {\r\n    handleOk: () => {\r\n\r\n    }\r\n  }\r\n  state = {\r\n    current: 1,\r\n    total: 0,\r\n    selectedRowKeys: [],\r\n  };\r\n  componentDidUpdate(preProps){\r\n    if (this.props.visible !== preProps.visible && !preProps.visible) {\r\n      this.setState({\r\n        selectedRowKeys: [],\r\n      });\r\n      this.getPageData();\r\n    }\r\n  }\r\n  getPageData = () => {\r\n    getHospitalList(this.state.current)\r\n    .then((res) => {\r\n      if (res.status === 1) {\r\n        this.setState({ dataSource: res.data, total: res.total });\r\n        return;\r\n      }\r\n      this.setState({ dataSource: [] });\r\n    })\r\n    .catch((e) => {\r\n      console.log(e);\r\n    });\r\n  };\r\n  onChangePage = page => {\r\n    this.setState({\r\n      current: page,\r\n    }, () => {\r\n      this.getPageData();\r\n    });\r\n  };\r\n  onSelectChange = (selectedRowKeys) => {\r\n    console.log('selectedRowKeys', selectedRowKeys);\r\n    this.setState({ selectedRowKeys });\r\n  }\r\n  handleOk = () => {\r\n    if(this.state.selectedRowKeys.length === 0){\r\n      message.error('请选择医院');\r\n      return;\r\n    }\r\n    console.log(this.state.selectedRowKeys[0]);\r\n    this.props.handleOk(this.state.selectedRowKeys[0]);\r\n  }\r\n  render() {\r\n    const rowSelection = {\r\n        type: 'radio',\r\n        selectedRowKeys: this.state.selectedRowKeys,\r\n        onChange: this.onSelectChange,\r\n    };\r\n    return (\r\n      <Modal\r\n        title=\"请选择医院进行指派\"\r\n        visible={this.props.visible}\r\n        onOk={this.handleOk}\r\n        onCancel={this.props.onCancel}\r\n      >\r\n        <Table\r\n          bordered\r\n          dataSource={this.state.dataSource}\r\n          columns={columns}\r\n          pagination={false}\r\n          rowKey={getRowKey}\r\n          size=\"small\"\r\n          rowSelection={rowSelection}\r\n        />\r\n        {/* <div className=\"clearfix\">\r\n          <Pagination\r\n            current={this.state.current}\r\n            total={this.state.total}\r\n            onChange={this.onChangePage}\r\n            style={{ float: \"right\", marginTop: \"16px\" }}\r\n          />\r\n        </div> */}\r\n      </Modal>\r\n    );\r\n  }\r\n}\r\n","import React from 'react';\r\nimport { Table, Pagination } from 'antd';\r\nimport { getRowKey } from '../../utils/util';\r\n\r\nexport default class Home extends React.Component {\r\n    render(){\r\n        const { columns, dataSource, current, total, onChangePage } = this.props;\r\n        console.log('total', total);\r\n        return (<div style={{ marginTop: '16px' }}>\r\n        <Table\r\n          bordered\r\n          dataSource={dataSource}\r\n          columns={columns}\r\n          pagination={false}\r\n          rowKey={getRowKey}\r\n          size=\"small\"\r\n        />\r\n        <div className='clearfix'>\r\n        <Pagination\r\n          current={current}\r\n          total={total}\r\n          // pageSize={2}\r\n          onChange={onChangePage}\r\n          style={{ float: 'right', marginTop: '16px' }}\r\n        />\r\n        </div>\r\n        </div>)\r\n    }\r\n}"],"sourceRoot":""}