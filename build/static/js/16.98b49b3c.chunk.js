(this.webpackJsonptemp=this.webpackJsonptemp||[]).push([[16,31],{212:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return b}));var n=a(101),i=a(29),r=a(30),l=a(32),o=a(31),c=a(33),s=a(0),u=a.n(s),p=a(100),d=a(43),m=a(786),f=a(789),h=a(788),g=a(374),b=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(o.a)(t).call(this,e))).getPageData=function(){Object(g.getHospitalNewsList)(a.state.current,a.state.hispitalList).then((function(e){if(1!==e.status)a.setState({dataSource:[]});else{var t=e.data.map((function(e){return e.operation?Object(n.a)({},e,{},e.operation):e}));a.setState({dataSource:t,total:e.total})}})).catch((function(e){console.log(e)}))},a.onChangePage=function(e){a.setState({current:e},(function(){a.getPageData()}))},a.openAdd=function(){a.setState({visible:!0,mode:"add",initData:{}})},a.openEdit=function(e){return function(){a.setState({visible:!0,mode:"edit",initData:e})}},a.onCancel=function(){a.setState({visible:!1,initData:{},mode:""})},a.addHandle=function(e){Object(g.addNews)(Object(n.a)({},e,{content:e.content.toHTML()})).then((function(e){if(1===e.status)return a.onCancel(),void a.getPageData();p.a.error("\u6dfb\u52a0\u5931\u8d25")})).catch((function(e){console.log(e)}))},a.editHandle=function(e){Object(g.editNews)(a.state.initData.id,{name:e.name,tag:e.tag,desc:e.desc,pic:e.pic,content:e.content.toHTML()}).then((function(e){if(1===e.status)return a.onCancel(),void a.getPageData();p.a.error("\u4fee\u6539\u5931\u8d25")})).catch((function(e){console.log(e)}))},a.onSubmit=function(e){console.log("v",e.content),e.pic?"add"!==a.state.mode?a.editHandle(e):a.addHandle(e):p.a.error("\u8bf7\u4e0a\u4f20\u56fe\u7247")},a.onDelete=function(e){return function(){}},a.showPreview=function(e,t){return function(){a.setState({previewVisible:!0,previewImage:e,renderMode:t})}},a.previewHandleCancel=function(){a.setState({previewVisible:!1,previewImage:""})},a.state={renderMode:"",previewVisible:!1,previewImage:"",mode:"",visible:!1,current:1,total:200,dataSource:[],formCfg:[{label:"\u533b\u9662",key:"hosp",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u533b\u9662!"}],type:"select",selectOptions:[]},{label:"\u6807\u9898",key:"name",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u6807\u9898!"}],type:"input"},{label:"\u7b80\u4ecb",key:"desc",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u7b80\u4ecb!"}],type:"input"},{label:"\u6807\u7b7e",key:"tag",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u6807\u7b7e!"}],type:"multipleSelect",selectOptions:[]},{label:"\u56fe\u7247",key:"pic",rules:[],type:"upload"},{label:"\u65b0\u95fb\u5185\u5bb9",key:"content",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u65b0\u95fb\u5185\u5bb9!"}],type:"braftEditor"}],initData:{},hispitalList:[]},a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.getPageData(),Object(g.getHospitalList)().then((function(t){if(1===t.status){var a=t.data.map((function(e){return{value:e.id,text:e.name}})),i=e.state.formCfg.map((function(e){return Object(n.a)({},e)}));i[0].selectOptions=a,e.setState({formCfg:i,hispitalList:t.data})}})).catch((function(e){console.log(e)})),Object(g.getLabelList)("\u65b0\u95fb").then((function(t){if(1===t.status){var a=e.state.formCfg.map((function(e){return Object(n.a)({},e)}));a[3].selectOptions=t.data.map((function(e){return{value:e.name,text:e.name}})),e.setState({formCfg:a})}})).catch((function(e){console.log(e)}))}},{key:"render",value:function(){var e=this,t=[{title:"\u6807\u9898",dataIndex:"name",key:"name",align:"center"},{title:"\u65b0\u95fb\u7b80\u4ecb",dataIndex:"desc",key:"desc",align:"center"},{title:"\u6807\u7b7e",dataIndex:"tag",key:"tag",align:"center",render:function(e){return e?e.join("\u3001"):null}},{title:"\u56fe\u7247",dataIndex:"pic",key:"pic",align:"center",render:function(t){return u.a.createElement("img",{onClick:e.showPreview(t),src:t,alt:"",style:{height:"20px"},className:"canClick"})}},{title:"\u65b0\u95fb\u5185\u5bb9",dataIndex:"content",key:"content",align:"center",render:function(t){return u.a.createElement("span",{className:"canClick",onClick:e.showPreview(t,"draft")},"\u8be6\u60c5")}},{title:"\u64cd\u4f5c",dataIndex:"action",key:"action",align:"center",width:100,render:function(t,a){return u.a.createElement("span",null,u.a.createElement(d.a,{type:"primary",style:{marginRight:"16px"},onClick:e.openEdit(a)},"\u4fee\u6539"))}}];return u.a.createElement("div",null,u.a.createElement(d.a,{type:"primary",onClick:this.openAdd},"\u6dfb\u52a0"),u.a.createElement(m.a,{current:this.state.current,total:this.state.total,columns:t,dataSource:this.state.dataSource,onChangePage:this.onChangePage}),u.a.createElement(f.a,{title:"add"===this.state.mode?"\u6dfb\u52a0":"\u4fee\u6539",visible:this.state.visible,formCfg:this.state.formCfg,initData:this.state.initData,onCancel:this.onCancel,onSubmit:this.onSubmit,width:1024}),u.a.createElement(h.a,{previewVisible:this.state.previewVisible,previewImage:this.state.previewImage,handleCancel:this.previewHandleCancel,renderMode:this.state.renderMode}))}}]),t}(u.a.Component)},374:function(e,t,a){"use strict";a.r(t),a.d(t,"getLabelList",(function(){return i})),a.d(t,"getArticleList",(function(){return r})),a.d(t,"addArticleList",(function(){return l})),a.d(t,"editArticleList",(function(){return o})),a.d(t,"deleteArticleList",(function(){return c})),a.d(t,"getPlatformNewsList",(function(){return s})),a.d(t,"getHospitalNewsList",(function(){return u})),a.d(t,"getHospitalList",(function(){return p})),a.d(t,"addNews",(function(){return d})),a.d(t,"editNews",(function(){return m})),a.d(t,"deleteNews",(function(){return f}));var n=a(68);function i(e){return Object(n.a)("get","/tag?type=".concat(e))}function r(e,t){return Object(n.a)("get","/".concat(e,"?page=").concat(t,"&limit=10"))}function l(e,t){return Object(n.a)("post","/".concat(e),t)}function o(e,t,a){return Object(n.a)("put","/".concat(e,"/").concat(t),a)}function c(e,t){return Object(n.a)("delete","/".concat(e,"/").concat(t))}function s(e){return Object(n.a)("get","/news?page=".concat(e,"&limit=10"))}function u(e){return Object(n.a)("get","/news/hospital?page=".concat(e,"&limit=10"))}function p(){return Object(n.a)("get","/hospital/hospitalAdmin?page=1&limit=1000")}function d(e){return Object(n.a)("post","/news",e)}function m(e,t){return Object(n.a)("put","/news/".concat(e),t)}function f(e){return Object(n.a)("delete","/news/".concat(e))}},786:function(e,t,a){"use strict";a.d(t,"a",(function(){return m}));var n=a(29),i=a(30),r=a(32),l=a(31),o=a(33),c=a(0),s=a.n(c),u=a(1085),p=a(854),d=a(152),m=function(e){function t(){return Object(n.a)(this,t),Object(r.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(o.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props,t=e.columns,a=e.dataSource,n=e.current,i=e.total,r=e.onChangePage;return console.log("total",i),s.a.createElement("div",{style:{marginTop:"16px"}},s.a.createElement(u.a,{bordered:!0,dataSource:a,columns:t,pagination:!1,rowKey:d.c,size:"small"}),s.a.createElement("div",{className:"clearfix"},s.a.createElement(p.a,{current:n,total:i,onChange:r,style:{float:"right",marginTop:"16px"}})))}}]),t}(s.a.Component)},788:function(e,t,a){"use strict";a.d(t,"a",(function(){return p}));var n=a(29),i=a(30),r=a(32),l=a(31),o=a(33),c=a(0),s=a.n(c),u=a(777),p=function(e){function t(){return Object(n.a)(this,t),Object(r.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(o.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props,t=e.previewVisible,a=e.previewImage,n=e.handleCancel,i=e.renderMode;return console.log("renderMode",i),s.a.createElement(u.a,{visible:t,footer:null,onCancel:n,title:"\u9884\u89c8",width:1024},s.a.createElement("div",{style:{height:"800px"},className:"clearfix"},"draft"===i?s.a.createElement("div",{dangerouslySetInnerHTML:{__html:a}}):s.a.createElement("img",{alt:"example",style:{width:"100%",height:"100%"},src:a})))}}]),t}(s.a.Component)},789:function(e,t,a){"use strict";var n,i,r=a(275),l=a(101),o=a(29),c=a(30),s=a(32),u=a(31),p=a(33),d=(a(794),a(0)),m=a.n(d),f=a(901),h=a(11),g=a(77),b=a(100),y=a(1087),v=a(192),k=a(1084),E=a(1088),O=a(1086),w=a(43),j=a(853),C=a(777),V=a(795),I=a.n(V),S=a(152),x=a(195),D=a(16),L=f.a.Option,P={labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:18}}},N=m.a.createElement("div",null,m.a.createElement(h.a,{type:"plus"}),m.a.createElement("div",{className:"ant-upload-text"},"Upload")),M={label:"label",value:"value",children:"children"};t.a=g.a.create({name:"form_modal"})((i=n=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,i=new Array(n),c=0;c<n;c++)i[c]=arguments[c];return(a=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).state={otherValues:{}},a.mapInit2=function(){setTimeout((function(){if(document.getElementById("map-containerpoi")){var e=new AMap.Map("map-containerpoi",{zoom:10});AMapUI.loadUI(["misc/PoiPicker"],(function(t){var n=new t({input:"pickerInput1"}),i=new AMap.Marker;n.on("poiPicked",(function(t){console.log(t.item.location),i.setMap(e),i.setPosition(t.item.location),a.setState({otherValues:Object(l.a)({},a.state.otherValues,{longitude:t.item.location.lng,latitude:t.item.location.lat})})}))}))}else console.log("not find")}))},a.handleChange=function(e){return function(t){console.log("info",t),"done"===t.file.status&&(1===t.file.response.status?(b.a.success("\u4e0a\u4f20\u6210\u529f"),a.setState({otherValues:Object(l.a)({},a.state.otherValues,Object(r.a)({},e,t.file.response.data[0]))})):b.a.error("\u4e0a\u4f20\u5931\u8d25")),"error "===t.file.status&&b.a.error("\u4e0a\u4f20\u5931\u8d25")}},a.onCreate=function(){a.props.form.validateFields((function(e,t){e||(console.log(t,a.state.otherValues),console.log(a.state.otherValues),a.props.onSubmit(Object(l.a)({},t,{},a.state.otherValues)))}))},a.onChange=function(e){a.value=e.target.value},a.addLabel=function(e){return function(){if(a.value){var t=a.state.otherValues[e]?a.state.otherValues[e].slice():[];t.push(a.value),a.setState({otherValues:Object(l.a)({},a.state.otherValues,Object(r.a)({},e,t))})}else b.a.error("\u8bf7\u8f93\u5165\u5185\u5bb9")}},a.confirm=function(e,t){return function(){var n=a.state.otherValues[t].filter((function(t){return t!==e}));a.setState({otherValues:Object(l.a)({},a.state.otherValues,Object(r.a)({},t,n))})}},a.renderFormItem=function(e){var t=D.a.getState().appStatus,n=a.props.form.getFieldDecorator;switch(e.type){case"timePicker":return m.a.createElement(g.a.Item,{key:e.key,label:e.label},n(e.key,{rules:e.rules,initialValue:a.props.initData[e.key]})(m.a.createElement(y.a,{format:"HH:mm"})));case"input":return m.a.createElement(g.a.Item,{key:e.key,label:e.label},n(e.key,{rules:e.rules,initialValue:a.props.initData[e.key]})(m.a.createElement(v.a,null)));case"treeSelect":return m.a.createElement(g.a.Item,{key:e.key,label:e.label},n(e.key,{rules:e.rules,initialValue:a.props.initData[e.key]})(m.a.createElement(k.a,{treeData:e.selectOptions,placeholder:"\u8bf7\u9009\u62e9",allowClear:!0})));case"select":return m.a.createElement(g.a.Item,{key:e.key,label:e.label},n(e.key,{rules:e.rules,initialValue:a.props.initData[e.key]})(m.a.createElement(f.a,{placeholder:"\u8bf7\u9009\u62e9"},e.selectOptions.map((function(e){return m.a.createElement(L,{key:e.value,value:e.value},e.text)})))));case"cascader":return m.a.createElement(g.a.Item,{key:e.key,label:e.label},n(e.key,{rules:e.rules,initialValue:a.props.initData[e.key]})(m.a.createElement(E.a,{fieldNames:e.fieldNames||M,options:e.selectOptions,placeholder:"\u8bf7\u9009\u62e9"})));case"upload":return m.a.createElement(g.a.Item,{required:!0,key:e.key,label:e.label},m.a.createElement(O.a,{className:"avatar-uploader",action:"".concat(x.a,"/upload"),onChange:a.handleChange(e.key),headers:{AccessToken:t.token},showUploadList:!1,beforeUpload:S.a,listType:"picture-card"},a.state.otherValues[e.key]?m.a.createElement("img",{alt:"",src:a.state.otherValues[e.key],style:{width:"100%"}}):N));case"multipleSelect":return m.a.createElement(g.a.Item,{key:e.key,label:e.label},n(e.key,{rules:e.rules,initialValue:a.props.initData[e.key]})(m.a.createElement(f.a,{mode:"multiple",placeholder:"\u8bf7\u9009\u62e9"},e.selectOptions.map((function(e){return m.a.createElement(L,{key:e.value,value:e.value},e.text)})))));case"longitudelatitudepoi":return m.a.createElement("div",{key:"longitudelatitudepoi",style:{marginTop:"16px",marginBottom:"16px"}},m.a.createElement(g.a.Item,{label:"\u7ecf\u7eac\u5ea6"},a.state.otherValues.longitude," ,",a.state.otherValues.latitude),m.a.createElement("div",{id:"map-containerpoi"}),m.a.createElement("div",{id:"pickerBox"},m.a.createElement("input",{id:"pickerInput1",placeholder:"\u8f93\u5165\u5173\u952e\u5b57\u9009\u53d6\u5730\u70b9"})));case"braftEditor":return m.a.createElement(g.a.Item,{key:e.key,label:e.label},n(e.key,{initialValue:I.a.createEditorState(a.props.initData[e.key]),validateTrigger:"onBlur",rules:[{required:!0,validator:function(e,t,a){t.isEmpty()?a("\u8bf7\u8f93\u5165\u6b63\u6587\u5185\u5bb9"):a()}}]})(m.a.createElement(I.a,{className:"my-editor",placeholder:"\u8bf7\u8f93\u5165\u6b63\u6587\u5185\u5bb9"})));case"tagInput":var i=a.state.otherValues[e.key]||[];return m.a.createElement(g.a.Item,{required:!0,key:e.key,label:e.label},m.a.createElement(v.a,{onChange:a.onChange,style:{width:"200px",marginRight:"16px"}}),m.a.createElement(w.a,{onClick:a.addLabel(e.key),type:"primary"},"\u6dfb\u52a0"),m.a.createElement("div",{style:{marginTop:"8px"}},i.map((function(t){return m.a.createElement(j.a,{key:t,title:"\u786e\u5b9a\u5220\u9664?",onConfirm:a.confirm(t,e.key),okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88"},m.a.createElement(w.a,{type:"primary",style:{marginRight:"8px"}},t,m.a.createElement(h.a,{type:"close-circle"})))}))));case"default":return m.a.createElement(g.a.Item,{key:e.key,label:e.label},e.defaultValue)}},a}return Object(p.a)(t,e),Object(c.a)(t,[{key:"componentDidUpdate",value:function(e){if(this.props.visible!==e.visible&&!e.visible){for(var t={},a=this.props.initKeys,n=0;n<a.length;n+=1)t[a[n]]=this.props.initData[a[n]];this.setState({otherValues:Object(l.a)({latitude:this.props.initData.latitude,longitude:this.props.initData.longitude,pic:this.props.initData.pic},t)}),this.mapInit2()}}},{key:"render",value:function(){var e=this.props,t=e.visible,a=e.onCancel,n=e.title,i=e.formCfg,r=e.width;return m.a.createElement(C.a,{visible:t,title:n,onCancel:a,onOk:this.onCreate,width:r},t&&m.a.createElement(g.a,Object.assign({},P,{layout:"vertical"}),i.map(this.renderFormItem)))}}]),t}(m.a.Component),n.defaultProps={initKeys:[]},i))}}]);
//# sourceMappingURL=16.98b49b3c.chunk.js.map