{"version":3,"sources":["pages/check/unauth/index.js","pages/check/unauth/checkModal.js","pages/check/unauth/service.js","components/rejectModal/index.js"],"names":["roleCfg","1","2","3","4","Home","p","getPageData","getUnauthUserList","state","current","then","res","status","setState","dataSource","data","total","catch","e","console","log","onChangePage","page","openCheckModal","record","authVisible","selectRow","onCancel","visible","showRejectModal","handleOk","v","checkUnauthUser","id","reason","message","success","error","onPassCheck","this","columns","title","dataIndex","key","align","render","map","value","join","width","className","onClick","type","style","marginRight","bordered","pagination","rowKey","getRowKey","size","onChange","float","React","Component","CheckModal","props","onOk","footer","name","idcard","height","alt","src","doc","Fetch","TextArea","Input","target","preProps","rows","defaultProps"],"mappings":"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","file":"static/js/13.a88e10c1.chunk.js","sourcesContent":["import React from \"react\";\r\nimport { Table, Pagination, Button, message } from \"antd\";\r\nimport CheckModal from \"./checkModal\";\r\nimport { getUnauthUserList, checkUnauthUser } from \"./service\";\r\nimport RejectModal from \"../../../components/rejectModal\";\r\n\r\nimport { getRowKey } from \"../../../utils/util\";\r\n\r\nconst roleCfg = {\r\n  1: \"普通用户\",\r\n  2: \"医院管理员\",\r\n  3: \"医院收费员\",\r\n  4: \"超级管理员\"\r\n};\r\n\r\nexport default class Home extends React.Component {\r\n  constructor(p) {\r\n    super(p);\r\n    this.state = {\r\n      visible: false,\r\n      authVisible: false,\r\n      current: 1,\r\n      total: 0,\r\n      dataSource: [],\r\n      selectRow: {}\r\n    };\r\n  }\r\n  componentDidMount() {\r\n    this.getPageData();\r\n  }\r\n  getPageData = () => {\r\n    getUnauthUserList(this.state.current)\r\n      .then(res => {\r\n        if (res.status === 1) {\r\n          this.setState({ dataSource: res.data, total: res.total });\r\n          return;\r\n        }\r\n        this.setState({ dataSource: [] });\r\n      })\r\n      .catch(e => {\r\n        console.log(e);\r\n      });\r\n  };\r\n  onChangePage = page => {\r\n    this.setState(\r\n      {\r\n        current: page\r\n      },\r\n      () => {\r\n        this.getPageData();\r\n      }\r\n    );\r\n  };\r\n\r\n  openCheckModal = record => () => {\r\n    this.setState({ authVisible: true, selectRow: record });\r\n  };\r\n  onCancel = () => {\r\n    this.setState({ visible: false, authVisible: false, selectRow: {} });\r\n  };\r\n\r\n  showRejectModal = (record) => () => {\r\n    this.setState({ visible: true, selectRow: record });\r\n  }\r\n\r\n  handleOk = v => {\r\n    console.log(\"v\", v);\r\n    checkUnauthUser(this.state.selectRow.id, { status: 0, reason: v })\r\n      .then(res => {\r\n        if (res.status === 1) {\r\n          message.success(\"操作成功\");\r\n          this.setState({ visible: false, selectRow: {} });\r\n          this.getPageData();\r\n          return;\r\n        }\r\n        message.error(\"操作失败\");\r\n      })\r\n      .catch(e => {\r\n        console.log(e);\r\n      });\r\n  };\r\n\r\n  onPassCheck = id => () => {\r\n    checkUnauthUser(id, { status: 1, reason: \"\" })\r\n      .then(res => {\r\n        if (res.status === 1) {\r\n          message.success(\"操作成功\");\r\n          this.getPageData();\r\n          return;\r\n        }\r\n        message.error(\"操作失败\");\r\n      })\r\n      .catch(e => {\r\n        console.log(e);\r\n      });\r\n  };\r\n\r\n  render() {\r\n    const columns = [\r\n      {\r\n        title: \"手机号\",\r\n        dataIndex: \"phone\",\r\n        key: \"phone\",\r\n        align: \"center\"\r\n      },\r\n      {\r\n        title: \"状态\",\r\n        dataIndex: \"status\",\r\n        key: \"status\",\r\n        align: \"center\"\r\n      },\r\n      {\r\n        title: \"角色\",\r\n        dataIndex: \"role\",\r\n        key: \"role\",\r\n        align: \"center\",\r\n        render: v => {\r\n          return v.map(value => roleCfg[value]).join(\"、\");\r\n        }\r\n      },\r\n      {\r\n        title: \"认证信息\",\r\n        dataIndex: \"authInfo\",\r\n        key: \"authInfo\",\r\n        align: \"center\",\r\n        width: 100,\r\n        render: (v, record) => {\r\n          return (\r\n            <div className='canClick' onClick={this.openCheckModal(record)}>\r\n              详情\r\n            </div>\r\n          );\r\n        }\r\n      },\r\n      {\r\n        title: \"操作\",\r\n        dataIndex: \"action\",\r\n        key: \"action\",\r\n        align: \"center\",\r\n        width: 200,\r\n        render: (v, record) => {\r\n          return (\r\n            <span>\r\n              <Button\r\n                type=\"primary\"\r\n                style={{ marginRight: \"16px\" }}\r\n                onClick={this.onPassCheck(record.id)}\r\n              >\r\n                通过\r\n              </Button>\r\n              <Button type=\"danger\" onClick={this.showRejectModal(record)}>\r\n                驳回\r\n              </Button>\r\n            </span>\r\n          );\r\n        },\r\n      }\r\n    ];\r\n    return (\r\n      <div>\r\n        <Table\r\n          bordered\r\n          dataSource={this.state.dataSource}\r\n          columns={columns}\r\n          pagination={false}\r\n          rowKey={getRowKey}\r\n          size=\"small\"\r\n        />\r\n        <Pagination\r\n          current={this.state.current}\r\n          total={this.state.total}\r\n          onChange={this.onChangePage}\r\n          style={{ float: \"right\" }}\r\n        />\r\n        <RejectModal\r\n         title=\"请填写驳回原因\"\r\n          visible={this.state.visible}\r\n          onCancel={this.onCancel}\r\n          handleOk={this.handleOk}\r\n        />\r\n        <CheckModal\r\n          visible={this.state.authVisible}\r\n          onCancel={this.onCancel}\r\n          selectRow={this.state.selectRow} \r\n        />\r\n      </div>\r\n    );\r\n  }\r\n}\r\n","import React from \"react\";\r\nimport { Modal } from \"antd\";\r\nimport \"./checkModal.scss\";\r\n\r\nexport default class CheckModal extends React.Component {\r\n  render() {\r\n    const { visible, onCancel, selectRow } = this.props;\r\n    return (\r\n      <Modal\r\n        visible={visible}\r\n        title=\"认证审核\"\r\n        onCancel={onCancel}\r\n        onOk={this.onOk}\r\n        footer={false}\r\n        width={1024}\r\n      >\r\n        <div className='check-modal'>\r\n          <ul>\r\n            <li className='item'>\r\n              <div className='title'>公司名称:</div>\r\n              <div className='value'>{selectRow.name}</div>\r\n            </li>\r\n            <li className='item'>\r\n              <div className='title'>组织机构代码:</div>\r\n              <div className='value'>{selectRow.idcard}</div>\r\n            </li>\r\n\r\n            <li className='item'>\r\n              <div className='title'>营业执照:</div>\r\n              <div className='value'><img style={{ height: '400px' }} alt=\"\" src={selectRow.doc && selectRow.doc[0]}/></div>\r\n            </li>\r\n            <li className='item'>\r\n              <div className='title'>授权书:</div>\r\n              <div className='value'><img style={{ height: '400px' }} alt=\"\" src={selectRow.doc && selectRow.doc[1]}/></div>\r\n            </li>\r\n          </ul>\r\n          </div>\r\n      </Modal>\r\n    );\r\n  }\r\n}\r\n","import Fetch from '../../../utils/fetch';\r\n\r\nexport function getUnauthUserList(page) {\r\n    // return Fetch('get', `/user?page=${page}&limit=10`);\r\n    return Fetch('get', `/user?page=${page}&limit=10&status=待审核`);\r\n}\r\n\r\nexport function checkUnauthUser(id, data) {\r\n    return Fetch('put', `/cert/${id}`, data);\r\n}","import React from \"react\";\r\nimport { Modal, Input, message } from \"antd\";\r\n\r\nconst { TextArea } = Input;\r\n\r\nexport default class Home extends React.Component {\r\n  state = {\r\n    value: \"\"\r\n  };\r\n  static defaultProps={\r\n    handleOk: () => {}\r\n  }\r\n  componentDidUpdate(preProps){\r\n    if (this.props.visible !== preProps.visible && !preProps.visible) {\r\n        this.setState({ value: '' });\r\n    }\r\n  }\r\n  onChange = e => {\r\n      console.log(e);\r\n    this.setState({ value: e.target.value });\r\n  };\r\n  handleOk = () => {\r\n      if(!this.state.value){\r\n          message.error('请填写');\r\n          return;\r\n      }\r\n      this.props.handleOk(this.state.value);\r\n  }\r\n  render() {\r\n    return (\r\n      <Modal\r\n        title={this.props.title}\r\n        visible={this.props.visible}\r\n        onOk={this.handleOk}\r\n        onCancel={this.props.onCancel}\r\n      >\r\n        <TextArea rows={4} onChange={this.onChange} value={this.state.value} />\r\n      </Modal>\r\n    );\r\n  }\r\n}\r\n"],"sourceRoot":""}