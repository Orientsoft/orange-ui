{"version":3,"sources":["pages/check/hospitalNewsCheck/index.js","pages/check/hospitalNewsCheck/service.js","components/comTable/index.js","components/previewModal/index.js","components/rejectModal/index.js"],"names":["Home","p","getPageData","getCheckNewsList","state","current","then","res","status","setState","dataSource","data","map","v","operation","total","catch","e","console","log","onChangePage","page","showRejectModal","record","visible","selectRow","onCancel","onPassCheck","id","checkNews","reason","message","success","error","handleOk","showPreview","url","renderMode","previewVisible","previewImage","previewHandleCancel","mode","this","columns","title","dataIndex","key","align","render","name","join","text","onClick","src","alt","style","height","className","width","type","marginRight","handleCancel","React","Component","Fetch","props","marginTop","bordered","pagination","rowKey","getRowKey","size","onChange","float","PreviewModal","footer","dangerouslySetInnerHTML","__html","TextArea","Input","value","target","preProps","onOk","rows","defaultProps"],"mappings":"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","file":"static/js/17.791a0523.chunk.js","sourcesContent":["import React from \"react\";\r\nimport { Button, message } from \"antd\";\r\nimport ComTable from \"../../../components/comTable\";\r\nimport RejectModal from '../../../components/rejectModal';\r\nimport PreviewModal from \"../../../components/previewModal\";\r\nimport { getCheckNewsList, checkNews } from './service';\r\n\r\nexport default class Home extends React.Component {\r\n  constructor(p) {\r\n    super(p);\r\n    this.state = {\r\n      renderMode: '',\r\n      previewVisible: false,\r\n      previewImage: \"\",\r\n      mode: \"\",\r\n      visible: false,\r\n      current: 1,\r\n      total: 0,\r\n      dataSource: [],\r\n      selectRow: {},\r\n    };\r\n  }\r\n  componentDidMount() {\r\n    this.getPageData();\r\n  }\r\n  getPageData = () => {\r\n    getCheckNewsList(this.state.current)\r\n      .then(res => {\r\n        if (res.status === 1) {\r\n          const dataSource = res.data.map(v => {\r\n            if(v.operation){\r\n              return { ...v, ...v.operation };\r\n            }\r\n            return v;\r\n          });\r\n          this.setState({ dataSource, total: res.total });\r\n          return;\r\n        }\r\n        this.setState({ dataSource: [] });\r\n      })\r\n      .catch(e => {\r\n        console.log(e);\r\n      });\r\n  };\r\n  onChangePage = page => {\r\n    this.setState({\r\n      current: page,\r\n    }, () => {\r\n      this.getPageData();\r\n    });\r\n  };\r\n  showRejectModal = (record) => () => {\r\n    this.setState({ visible: true, selectRow: record });\r\n  }\r\n  onCancel = () => {\r\n    this.setState({\r\n      visible: false,\r\n    });\r\n  };\r\n  onPassCheck = (id) => () => {\r\n    checkNews({ id, status: 1, reason: '' })\r\n    .then(res => {\r\n      if (res.status === 1) {\r\n        message.success('操作成功');\r\n        this.getPageData();\r\n        return;\r\n      }\r\n      message.error('操作失败');\r\n    })\r\n    .catch(e => {\r\n      console.log(e);\r\n    });\r\n  }\r\n  handleOk = (reason) => {\r\n    checkNews({ id: this.state.selectRow.id, status: 0, reason })\r\n    .then(res => {\r\n      if (res.status === 1) {\r\n        message.success('操作成功');\r\n        this.onCancel();\r\n        this.getPageData();\r\n        return;\r\n      }\r\n      message.error('操作失败');\r\n    })\r\n    .catch(e => {\r\n      console.log(e);\r\n    });\r\n  }\r\n  showPreview = (url, renderMode) => () => {\r\n    this.setState({ previewVisible: true, previewImage: url, renderMode });\r\n  };\r\n  previewHandleCancel = () => {\r\n    this.setState({ previewVisible: false, previewImage: \"\" });\r\n  };\r\n  render() {\r\n    const columns = [\r\n      {\r\n        title: \"医院\",\r\n        dataIndex: \"hosp\",\r\n        key: \"hosp\",\r\n        align: \"center\",\r\n        render: (v) => {\r\n          return v ? v.name : '';\r\n        }\r\n      },\r\n      {\r\n        title: \"新闻标题\",\r\n        dataIndex: \"name\",\r\n        key: \"name\",\r\n        align: \"center\"\r\n      },\r\n      {\r\n        title: \"标签\",\r\n        dataIndex: \"tag\",\r\n        key: \"tag\",\r\n        align: \"center\",\r\n        render: v => {\r\n          if (!v) {\r\n            return null;\r\n          }\r\n          return v.join(\"、\");\r\n        }\r\n      },\r\n      {\r\n        title: \"简介\",\r\n        dataIndex: \"desc\",\r\n        key: \"desc\",\r\n        align: \"center\"\r\n      },\r\n      {\r\n        title: \"图片\",\r\n        dataIndex: \"pic\",\r\n        key: \"pic\",\r\n        align: \"center\",\r\n        render: text => {\r\n          return (\r\n            <img\r\n              onClick={this.showPreview(text)}\r\n              src={text}\r\n              alt=\"\"\r\n              style={{ height: \"20px\" }}\r\n              className=\"canClick\"\r\n            />\r\n          );\r\n        }\r\n      },\r\n      {\r\n        title: \"新闻内容\",\r\n        dataIndex: \"content\",\r\n        key: \"content\",\r\n        align: \"center\",\r\n        render: text => {\r\n          return (\r\n            <span className=\"canClick\" onClick={this.showPreview(text, 'draft')}>详情</span>\r\n          );\r\n        }\r\n      },\r\n      {\r\n        title: \"操作\",\r\n        dataIndex: \"action\",\r\n        key: \"action\",\r\n        align: \"center\",\r\n        width: 200,\r\n        render: (v, record) => {\r\n          return (\r\n            <span>\r\n              <Button type='primary' style={{ marginRight: '16px' }} onClick={this.onPassCheck(record.id)}>通过</Button>\r\n              <Button type='danger' onClick={this.showRejectModal(record)}>驳回</Button>\r\n            </span>\r\n          );\r\n        }\r\n      }\r\n    ];\r\n    return (\r\n      <div>\r\n        <ComTable\r\n          current={this.state.current}\r\n          total={this.state.total}\r\n          columns={columns}\r\n          dataSource={this.state.dataSource}\r\n          onChangePage={this.onChangePage}\r\n        />\r\n        <RejectModal\r\n         title=\"请填写驳回原因\"\r\n        visible={this.state.visible}\r\n        onCancel={this.onCancel}\r\n        handleOk={this.handleOk} \r\n        />\r\n                        <PreviewModal\r\n          previewVisible={this.state.previewVisible}\r\n          previewImage={this.state.previewImage}\r\n          handleCancel={this.previewHandleCancel}\r\n          renderMode={this.state.renderMode}\r\n        />\r\n      </div>\r\n    );\r\n  }\r\n}\r\n","import Fetch from '../../../utils/fetch';\r\n\r\nexport function getCheckNewsList(page) {\r\n    return Fetch('get', `/news/operation?page=${page}&limit=10`);\r\n}\r\n\r\nexport function checkNews(data) {\r\n    return Fetch('put', '/news/check', data);\r\n}","import React from 'react';\r\nimport { Table, Pagination } from 'antd';\r\nimport { getRowKey } from '../../utils/util';\r\n\r\nexport default class Home extends React.Component {\r\n    render(){\r\n        const { columns, dataSource, current, total, onChangePage } = this.props;\r\n        console.log('total', total);\r\n        return (<div style={{ marginTop: '16px' }}>\r\n        <Table\r\n          bordered\r\n          dataSource={dataSource}\r\n          columns={columns}\r\n          pagination={false}\r\n          rowKey={getRowKey}\r\n          size=\"small\"\r\n        />\r\n        <div className='clearfix'>\r\n        <Pagination\r\n          current={current}\r\n          total={total}\r\n          // pageSize={2}\r\n          onChange={onChangePage}\r\n          style={{ float: 'right', marginTop: '16px' }}\r\n        />\r\n        </div>\r\n        </div>)\r\n    }\r\n}","import React from \"react\";\r\nimport { Modal } from \"antd\";\r\n\r\nexport default class PreviewModal extends React.Component {\r\n  render() {\r\n    const { previewVisible, previewImage, handleCancel, renderMode } = this.props;\r\n    console.log('renderMode', renderMode);\r\n    return (\r\n        <Modal\r\n          visible={previewVisible}\r\n          footer={null}\r\n          onCancel={handleCancel}\r\n          title='预览'\r\n          width={1024}\r\n        >\r\n          <div style={{ height: '800px' }} className='clearfix'>\r\n          {\r\n            renderMode === 'draft' ? <div dangerouslySetInnerHTML={{\r\n              __html: previewImage }}></div> : <img alt=\"example\" style={{ width: \"100%\", height: \"100%\" }} src={previewImage} />\r\n          }\r\n          </div>\r\n        </Modal>\r\n    );\r\n  }\r\n}\r\n","import React from \"react\";\r\nimport { Modal, Input, message } from \"antd\";\r\n\r\nconst { TextArea } = Input;\r\n\r\nexport default class Home extends React.Component {\r\n  state = {\r\n    value: \"\"\r\n  };\r\n  static defaultProps={\r\n    handleOk: () => {}\r\n  }\r\n  componentDidUpdate(preProps){\r\n    if (this.props.visible !== preProps.visible && !preProps.visible) {\r\n        this.setState({ value: '' });\r\n    }\r\n  }\r\n  onChange = e => {\r\n      console.log(e);\r\n    this.setState({ value: e.target.value });\r\n  };\r\n  handleOk = () => {\r\n      if(!this.state.value){\r\n          message.error('请填写');\r\n          return;\r\n      }\r\n      this.props.handleOk(this.state.value);\r\n  }\r\n  render() {\r\n    return (\r\n      <Modal\r\n        title={this.props.title}\r\n        visible={this.props.visible}\r\n        onOk={this.handleOk}\r\n        onCancel={this.props.onCancel}\r\n      >\r\n        <TextArea rows={4} onChange={this.onChange} value={this.state.value} />\r\n      </Modal>\r\n    );\r\n  }\r\n}\r\n"],"sourceRoot":""}